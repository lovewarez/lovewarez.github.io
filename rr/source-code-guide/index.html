<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Introduction - RuggRogue Source Code Guide</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Design and source code breakdown of a simple roguelike">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="book/outlink.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html" class="active">Introduction</a></li><li class="chapter-item expanded "><a href="dependencies.html"><strong aria-hidden="true">1.</strong> Dependencies</a></li><li class="chapter-item expanded "><a href="source-code-layout.html"><strong aria-hidden="true">2.</strong> Source Code Layout</a></li><li class="chapter-item expanded "><a href="overall-game-flow.html"><strong aria-hidden="true">3.</strong> Overall Game Flow</a></li><li class="chapter-item expanded "><a href="event-handling.html"><strong aria-hidden="true">4.</strong> Event Handling</a></li><li class="chapter-item expanded "><a href="rendering.html"><strong aria-hidden="true">5.</strong> Rendering</a></li><li class="chapter-item expanded "><a href="user-interface.html"><strong aria-hidden="true">6.</strong> User Interface</a></li><li class="chapter-item expanded "><a href="options.html"><strong aria-hidden="true">7.</strong> Options</a></li><li class="chapter-item expanded "><a href="word-wrapping.html"><strong aria-hidden="true">8.</strong> Word Wrapping</a></li><li class="chapter-item expanded "><a href="entity-component-system.html"><strong aria-hidden="true">9.</strong> Entity Component System</a></li><li class="chapter-item expanded "><a href="game-data.html"><strong aria-hidden="true">10.</strong> Game Data</a></li><li class="chapter-item expanded "><a href="saving-and-loading.html"><strong aria-hidden="true">11.</strong> Saving and Loading</a></li><li class="chapter-item expanded "><a href="field-of-view.html"><strong aria-hidden="true">12.</strong> Field of View</a></li><li class="chapter-item expanded "><a href="pathfinding.html"><strong aria-hidden="true">13.</strong> Pathfinding</a></li><li class="chapter-item expanded "><a href="randomness.html"><strong aria-hidden="true">14.</strong> Randomness</a></li><li class="chapter-item expanded "><a href="map-generation.html"><strong aria-hidden="true">15.</strong> Map Generation</a></li><li class="chapter-item expanded "><a href="map-population.html"><strong aria-hidden="true">16.</strong> Map Population</a></li><li class="chapter-item expanded "><a href="auto-run.html"><strong aria-hidden="true">17.</strong> Auto-Run</a></li><li class="chapter-item expanded "><a href="turn-order-and-combat.html"><strong aria-hidden="true">18.</strong> Turn Order and Combat</a></li><li class="chapter-item expanded "><a href="items.html"><strong aria-hidden="true">19.</strong> Items</a></li><li class="chapter-item expanded "><a href="hunger-and-regeneration.html"><strong aria-hidden="true">20.</strong> Hunger and Regeneration</a></li><li class="chapter-item expanded "><a href="experience-and-difficulty.html"><strong aria-hidden="true">21.</strong> Experience and Difficulty</a></li><li class="chapter-item expanded "><a href="monsters.html"><strong aria-hidden="true">22.</strong> Monsters</a></li><li class="chapter-item expanded "><a href="new-game-plus.html"><strong aria-hidden="true">23.</strong> New Game Plus</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">RuggRogue Source Code Guide</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>Welcome to the <em>RuggRogue Source Code Guide</em>!
This is a web book describing the internal workings of <a href="https://tung.github.io/ruggrogue/">RuggRogue</a>: a simple, complete roguelike inspired by the first part of the <a href="https://bfnightly.bracketproductions.com">Rust Roguelike Tutorial</a>.
Unlike that tutorial, however, it's made without the help of any game engine or roguelike helper libraries, instead relying on <a href="https://libsdl.org">SDL2</a>, with <a href="https://emscripten.org">Emscripten</a> for the web port.</p>
<p>RuggRogue itself plays out like many other roguelikes: You fight your way down a procedurally generated dungeon through ever-stronger monsters.
Along the way you'll find weapons, armor and magical items that will aid you in your quest.</p>
<p>The source code of RuggRogue can be found at <a href="https://github.com/tung/ruggrogue">its GitHub repository</a>.
It consists of thirteen thousand lines of Rust code across forty four files.
How does it all fit together?
Read on and find out!</p>
<h2 id="about-this-book"><a class="header" href="#about-this-book">About this Book</a></h2>
<p>RuggRogue is a relatively small open source game, so in theory everything about how it works could be learned by simply reading its source code.
However, the code is arranged for the computer to run first and foremost, so broad ideas are obscured by a vast sea of details.
The aim of this book is to highlight these ideas, from a high-level perspective all the way down to how they translate into functions and variables.</p>
<p>Studying the code architecture of RuggRogue is interesting for a few reasons.
The game is directly inspired by the numerous roguelike tutorials that can found across the Internet, but it goes beyond them in a number of ways.
It directly implements algorithms that tutorials typically provide canned solutions to, such as field of view and pathfinding.
It also answers questions that such tutorials typically leave as an exercise to the reader, such as game balance, word wrapping and auto-run.</p>
<p>At the same time, RuggRogue is a complete game with a limited scope that doesn't go too much further than those roguelike tutorials.
A person who has followed one of them has a realistic chance of learning from the RuggRogue source code without being overwhelmed.</p>
<p>Finally, RuggRogue's source code architecture differs quite a bit from most roguelike tutorials.
RuggRogue arranges a lot of its logic into <em>game states</em> with an explicit <em>game state stack</em> (internally referred to as <em>&quot;modes&quot;</em> and <em>&quot;the mode stack&quot;</em>).
This allows different screens and menus to keep their data and the code very close together.
This technique is hard to find in roguelike tutorials, but it's described in this book.</p>
<h2 id="who-is-this-book-for"><a class="header" href="#who-is-this-book-for">Who is this Book for?</a></h2>
<p>This book is written for programmers, so prior knowledge is assumed for things like variables, branches, loops, functions and basic data structures such as stacks, vectors and hash maps.</p>
<p>The game is written in the Rust programming language, but I try to keep it simple, so Rust knowledge is helpful to follow along but not mandatory.
Readers coming from other programming languages may want to look up Rust topics such as <a href="https://doc.rust-lang.org/book/ch10-02-traits.html"><em>traits</em></a> (like interfaces in other languages), <a href="https://doc.rust-lang.org/book/ch07-05-separating-modules-into-different-files.html"><em>modules</em></a>, <a href="https://doc.rust-lang.org/book/ch06-00-enums.html"><em>pattern matching</em></a> and <a href="https://doc.rust-lang.org/book/ch13-02-iterators.html"><em>iterators</em></a>.</p>
<p>If you're an aspiring roguelike developer, this book will give you broad idea of the scope of a roguelike.
Reading a chapter in detail should serve as useful guidance as to how to implement features yourself.</p>
<p>If you're developing a roguelike yourself already, this book should serve as an interesting case study to compare and contrast your existing approaches to various features.
You may stumble across ideas you hadn't thought of to enhance the game you're working on.</p>
<p>If you're a programmer that's curious about game development in general, this book will shed some light on how a game functions under the hood.
Everything game-related must be handled by the source code, since there's no game engine for anything to hide in.</p>
<h2 id="how-to-read-this-book"><a class="header" href="#how-to-read-this-book">How to Read this Book</a></h2>
<p>Each chapter of the book is more or less standalone, so they can mostly be read in any order.
There are a few cross-references, most of which point backwards.</p>
<p>Chapters vary in balance between describing high-level ideas and fine-grained technical details.
Unfortunately, the early chapters are fairly detail-heavy due to establishing the technical base upon which all of the (hopefully) fun gameplay is built upon.
If it becomes too much to bear, feel free to skip the chapter and come back later.</p>
<p>In all of the chapters, there are many references to the names of files, functions, variables and other code-specific things.
You'll get the most out of this book with the source code handy in another window.</p>
<p>On the other hand, if you're not interested in juggling the game's source code while reading the book, you can still skim the chapters just for the ideas and skip over the source code references.</p>
<h2 id="chapter-overview"><a class="header" href="#chapter-overview">Chapter Overview</a></h2>
<p><a href="dependencies.html"><strong>Dependencies</strong></a>: The technology, libraries and tools used to create the game.</p>
<p><a href="source-code-layout.html"><strong>Source Code Layout</strong></a>: The location and purpose of each file and directory of the source code.</p>
<p><a href="overall-game-flow.html"><strong>Overall Game Flow</strong></a>: Game initialization, game loop and mode (game state) stack.</p>
<p><a href="event-handling.html"><strong>Event Handling</strong></a>: Handling of external events such as player input, window resizing and closing.</p>
<p><a href="rendering.html"><strong>Rendering</strong></a>: Drawing grids of tiles onto the screen and performance-improving techniques.</p>
<p><a href="user-interface.html"><strong>User Interface</strong></a>: How menus work and screens are laid out.</p>
<p><a href="options.html"><strong>Options</strong></a>: The options menu and how option changes are reflected in real-time.</p>
<p><a href="word-wrapping.html"><strong>Word Wrapping</strong></a>: How long lines of text are broken up to fit inside a limited space.</p>
<p><a href="entity-component-system.html"><strong>Entity Component System</strong></a>: How data is stored, retrieved and modified.</p>
<p><a href="game-data.html"><strong>Game Data</strong></a>: The different types of data components and how entities are created and destroyed.</p>
<p><a href="saving-and-loading.html"><strong>Saving and Loading</strong></a>: What save files look like and how they work.</p>
<p><a href="field-of-view.html"><strong>Field of View</strong></a>: Determining which tiles the player and monsters can see using shadow casting.</p>
<p><a href="pathfinding.html"><strong>Pathfinding</strong></a>: A* search algorithm for finding paths between points, its uses and subtleties.</p>
<p><a href="randomness.html"><strong>Randomness</strong></a>: Pseudo-random number generation, seeds and reproducibility of results.</p>
<p><a href="map-generation.html"><strong>Map Generation</strong></a>: Data structures and logic for randomly laying out rooms, corridors and stairs.</p>
<p><a href="map-population.html"><strong>Map Population</strong></a>: Placement of the player, monsters and items in freshly-generated maps.</p>
<p><a href="auto-run.html"><strong>Auto-Run</strong></a>: Implementing the smart directional &quot;auto-run&quot; movement command that follows corridors and crosses open space.</p>
<p><a href="turn-order-and-combat.html"><strong>Turn Order and Combat</strong></a>: Monster turns, melee combat, damage formula and death handling.</p>
<p><a href="items.html"><strong>Items</strong></a>: List of items, spawn rates, item-related data structures, menus and usage logic.</p>
<p><a href="hunger-and-regeneration.html"><strong>Hunger and Regeneration</strong></a>: How hunger fits into the rest of the game and its link to regeneration.</p>
<p><a href="experience-and-difficulty.html"><strong>Experience and Difficulty</strong></a>: Game balance, numeric progression and pacing the flow of new monsters, weapons and armor.</p>
<p><a href="monsters.html"><strong>Monsters</strong></a>: Mini-chapter with a list of monsters and cross-references to other chapters about how they work.</p>
<p><a href="new-game-plus.html"><strong>New Game Plus</strong></a>: Gameplay and implementation details of how successive wins change play-throughs.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->

                            <a rel="next" href="dependencies.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

                    <a rel="next" href="dependencies.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
